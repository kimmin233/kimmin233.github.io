---
title: "[ch02-2] νΌμ κ³µλ¶€ν•λ” λ¨Έμ‹ λ¬λ‹ + λ”¥λ¬λ‹"
description: λ°μ΄ν„° λ‹¤λ£¨κΈ° _ μμƒν• μƒμ„ μ„ μ΅°μ‹¬ν•λΌ!
categories: 
 - νΌκ³µλ¨Έμ‹ 
tags: [AI, Machine Learning, Deep Learning]
---

<!-- λ‚΄μ© -->

# 02-2 λ°μ΄ν„° μ „μ²λ¦¬

<br>
μ•μ—μ„ μ‚¬μ©ν–λ λ„λ―Έμ™€ λΉ™μ–΄ λ°μ΄ν„°λ¥Ό λ³΄λ©΄ λ„λ―Έλ” κΈΈμ΄μ™€ λ¬΄κ²κ°€ ν° νΈμ΄κ³  λΉ™μ–΄λ” μ‘μ€ νΈμ΄μ—λ‹¤. <br>
λ§μ•½, λΉ™μ–΄μ²λΌ μ‘μ€ λ„λ―Έκ°€ μκ±°λ‚ λ„λ―Έμ²λΌ ν° λΉ™μ–΄κ°€ μλ‹¤λ©΄ ?! <br>

### λ„νμ΄λ΅ λ°μ΄ν„° μ¤€λΉ„ν•κΈ°

λ¨Όμ € μ•μ—μ„ ν–λ λ°μ΄ν„°μ™€λ” λ‹¤λ¥Έ λ°μ΄ν„°λ¥Ό μ¤€λΉ„ν•μ. <br>
> λ…ΈνΈλ¶μ—μ„ μƒλ΅μ΄ μ…€μ„ λ§λ“¤μ–΄μ„ μ…λ ¥ <br>

π‘‰ [λ„λ―Έμ™€ λΉ™μ–΄ λ¦¬μ¤νΈ2](https://gist.github.com/rickiepark/b90b9f725890653e69a1a52943671c62)

```python
fish_length = [25.4, 26.3, 26.5, 29.0, 29.0, 29.7, 29.7, 30.0, 30.0, 30.7, 31.0, 31.0, 
                31.5, 32.0, 32.0, 32.0, 33.0, 33.0, 33.5, 33.5, 34.0, 34.0, 34.5, 35.0, 
                35.0, 35.0, 35.0, 36.0, 36.0, 37.0, 38.5, 38.5, 39.5, 41.0, 41.0, 9.8, 
                10.5, 10.6, 11.0, 11.2, 11.3, 11.8, 11.8, 12.0, 12.2, 12.4, 13.0, 14.3, 15.0]
fish_weight = [242.0, 290.0, 340.0, 363.0, 430.0, 450.0, 500.0, 390.0, 450.0, 500.0, 475.0, 500.0, 
                500.0, 340.0, 600.0, 600.0, 700.0, 700.0, 610.0, 650.0, 575.0, 685.0, 620.0, 680.0, 
                700.0, 725.0, 720.0, 714.0, 850.0, 1000.0, 920.0, 955.0, 925.0, 975.0, 950.0, 6.7, 
                7.5, 7.0, 9.7, 9.8, 8.7, 10.0, 9.9, 9.8, 12.2, 13.4, 12.2, 19.7, 19.9]
```

λ„νμ΄λ¥Ό import ν•κ³  λ„νμ΄μ **column_stack()** ν•¨μλ¥Ό μ΄μ©ν•΄ fish_lengthμ™€ fish_weightλ¥Ό ν•©μΉμ. <br>
 > column_stack() ν•¨μλ” μ „λ‹¬λ°›μ€ λ¦¬μ¤νΈλ¥Ό μΌλ ¬λ΅ μ„Έμ΄ λ‹¤μ **μ°¨λ΅€λ€λ΅ λ‚λ€ν μ—°κ²°**ν•΄μ¤€λ‹¤. <br>
 μ—°κ²°ν•  λ¦¬μ¤νΈλ” **νν”**λ΅ μ „λ‹¬ν•λ‹¤. <br> 

```python
import numpy as np
fish_data = np.column_stack((fish_length, fish_weight))
```

λ¦¬μ¤νΈκ°€ μ μ—°κ²°λλ”μ§€ μ²μ 3κ°μ λ°μ΄ν„°λ¥Ό ν™•μΈν•΄λ³΄λ©΄ <br>
![column1](/assets/images/ch02/column1.JPG "ν–‰κ³Ό μ—΄μ΄ κµ¬λ¶„λΌμ„ μ¶λ ¥λλ‹¤ π™‚")

> column_stack(A, B)μ Aλ” μ²« λ²μ§Έ μ—΄λ΅, Bλ” λ‘ λ²μ§Έ μ—΄λ΅ λ“¤μ–΄κ°„ κ²ƒμ„ μ• μ μλ‹¤. <br>

λ™μΌν•κ² νƒ€κΉƒ λ°μ΄ν„°λ„ λ§λ“ λ‹¤. <br>
μ΄μ „μ—λ” 0κ³Ό 1μ„ κ°―μλ§νΌ κ³±ν•΄μ„ μ…λ ¥ν•΄μ¤¬λ”λ° μ΄λ²μ—” λ” λ‚μ€ λ°©λ²•μΈ **ones()**μ™€ **zeros()** ν•¨μλ¥Ό μ΄μ©ν•΄ κ°κ° μ›ν•λ” κ°μμ 1κ³Ό 0μ„ μ±„μ΄ λ°°μ—΄μ„ λ§λ“¤μ–΄μ„ μ…λ ¥ν•΄λ³΄μ. <br>

μλ¥Ό λ“¤λ©΄ np.ones(5)λ”<br>
```python
print(np.ones(5))
```

![column2](/assets/images/ch02/column2.JPG)
1μ΄ 5κ°μΈ λ°°μ—΄μ΄ λ§λ“¤μ–΄μ§„λ‹¤. <br>
κ°™μ€ λ°©μ‹μΌλ΅ zeros(N)λ” 0μ΄ Nκ°μΈ λ°°μ—΄μ΄ λ§λ“¤μ–΄μ§€λ” κ²ƒμ΄λ‹¤. <br>

μ΄ λ‘ ν•¨μλ¥Ό μ΄μ©ν•΄ 1μ΄ 35κ°μΈ λ°°μ—΄κ³Ό 0μ΄ 14κ°μΈ λ°°μ—΄μ„ λ§λ“¤ μ μκ³  **concatenate()**ν•¨μλ¥Ό μ‚¬μ©ν•΄ λ‘ λ°°μ—΄μ„ μ—°κ²°ν•΄λ³΄μ. <br>

```python
fish_target = np.concatenate((np.ones(35), np.zeros(14))
```

![fish_target](/assets/images/ch02/fish_target1.JPG)

+ column_stack()κ³Ό concatenate()μ μ°¨μ΄μ  ? <br>
 column_stack() ν•¨μλ” κ° λ¦¬μ¤νΈλ¥Ό μ—΄μ— ν•λ‚μ”© λ„£κ³  concatenate() ν•¨μλ” μ• λ¦¬μ¤νΈ λ’¤μ— λ’· λ¦¬μ¤νΈλ¥Ό λ¶™μΈλ‹¤. <br>
 μλ¥Ό λ“¤λ©΄ μ΄λ ‡κ² ν‘ν„ν•  μ μλ‹¤. π‘‡
 ![difference](/assets/images/ch02/st_con.JPG)


μ΄μ  ν›λ ¨ μ„ΈνΈμ™€ ν…μ¤νΈ μ„ΈνΈλ¥Ό λ‚λ λ³΄μ.


### μ‚¬μ΄ν‚·λ°μΌλ΅ ν›λ ¨ μ„ΈνΈμ™€ ν…μ¤νΈ μ„ΈνΈ λ‚λ„κΈ°

ν›λ ¨ μ„ΈνΈμ™€ ν…μ¤νΈ μ„ΈνΈλ¥Ό λΉ„μ¨μ— λ§κ² λ‚λ„κΈ° μ„ν•΄ μ‚¬μ΄ν‚·λ°μ **train_test_split()**ν•¨μλ¥Ό μ‚¬μ©ν•λ‹¤. <br>
μ΄ ν•¨μμ— λ‚λ„κ³  μ‹¶μ€ λ¦¬μ¤νΈλ‚ λ°°μ—΄μ„ μ›ν•λ” λ§νΌ μ „λ‹¬ν•λ©΄ λλ‹¤. <br>
μ‚¬μ©ν•κΈ°μ— μ•μ„ train_test_split() ν•¨μλ” μ‚¬μ΄ν‚·λ°μ model_selection λ¨λ“ μ•„λμ— μμ–΄μ„ import ν•΄μ¤€λ‹¤.
```python
from sklearn.model_selection import train_test_split
```
<br>
train_test_split()ν•¨μλ΅ fish_dataμ™€ fish_targetμ„ train_input, test_input, train_target, test_targetμΌλ΅ λ‚λ μ•Όν•λ‹¤.<br>
μ•μ„ ν–λ random.seed()ν•¨μλ¥Ό μ‚¬μ©ν•΄ μ¶λ ¥ κ²°κ³Όμ™€ μ±…μ κ²°κ³Όμ™€ λ™μΌν•κ² ν•΄μ¤€ κ²ƒ μ²λΌ train_test_split()ν•¨μμ—λ” μμ²΄μ μΌλ΅ λλ¤ μ‹λ“λ¥Ό μ§€μ •ν•  μ μλ” random_state λ§¤κ°λ³€μκ°€ μ΅΄μ¬ν•λ‹¤.<br>
μ•μ—μ„ λλ¤μ‹λ“λ¥Ό 42λ΅ μ„¤μ •ν• κ²ƒκ³Ό λ™μΌν•κ² random_state λ§¤κ°λ³€μλ¥Ό 42λ΅ μ„¤μ •ν•λ‹¤.
```python
train_input, test_input, train_target, test_target = train_test_split(fish_data, fish_target, random_state=42)
```
<br>
μ΄ ν•¨μλ” κΈ°λ³Έμ μΌλ΅ 25%λ¥Ό ν…μ¤νΈ μ„ΈνΈλ΅ λ–Όμ–΄λ‚Έλ‹¤. <br>
μ λ‚λ„μ—λ”μ§€ ν™•μΈν•κΈ° μ„ν•΄ λ„νμ΄ λ°°μ—΄μ shape μ†μ„±μΌλ΅ μ…λ ¥ λ°μ΄ν„°μ ν¬κΈ°λ¥Ό μ¶λ ¥ν•΄λ³΄μ.<br>
```python
print(train_input.shape, test_input.shape)
print(train_target.shape, test_target.shape)
```

![shapeofdata](/assets/images/ch02/split_shape.JPG)

μ¶λ ¥ κ²°κ³Όλ¥Ό ν†µν•΄ ν›λ ¨ λ°μ΄ν„°μ™€ ν…μ¤νΈ λ°μ΄ν„°κ°€ κ°κ° 36, 13κ°λ΅ λ‚λ„μ–΄μ§„ κ²ƒμ„ ν™•μΈν•  μ μλ‹¤. <br> 
> νν”μ μ›μ†κ°€ ν•λ‚μΌ κ²½μ° μ›μ† λ’¤μ— μ½¤λ§(,)λ¥Ό μ¶”κ°€ν•λ‹¤. <br>
 μ…λ ¥ λ°μ΄ν„°(_input)μ ( , 2)λ” 2κ°μ μ—΄μ΄ μλ” 2μ°¨μ› λ°°μ—΄μ„ μλ―Έν•κ³ , νƒ€κΉƒ λ°μ΄ν„°(_target)μ ( ,)λ” 1μ°¨μ› λ°°μ—΄μ„ μλ―Έν•λ‹¤. <br>


ν…μ¤νΈ λ°μ΄ν„°λ¥Ό μ¶λ ¥ν•΄ λ„λ―Έμ™€ λΉ™μ–΄κ°€ μ μ„μ€λ”μ§€ μ¶λ ¥ν•΄λ³΄μ.
```python
print(test_target)
```

![testtarget](/assets/images/ch02/test_target2.JPG)

μ΄ 13κ°μ ν…μ¤νΈ μ„ΈνΈ μ¤‘μ— 10κ°λ” λ„λ―Έ(1), 3κ°λ” λΉ™μ–΄(0)λ‹¤. <br>
κ·Έλ΄λ“―ν•κ² μ„μ—¬μμ§€λ§ μ²« λ²μ§Έ ν…μ¤νΈ μ„ΈνΈμΈ '1' μ΄ μ μ°μ°ν•λ‹¤. <br>
μ›λ λ„λ―Έμ™€ λΉ™μ–΄μ κ°μλ” 35 : 14 μ΄λ―€λ΅ λ‘ μƒμ„ μ λΉ„μ¨μ€ 2.5 : 1 μΈλ° μ΄ ν…μ¤νΈ μ„ΈνΈλ” 10 : 3 μΌλ΅ λΉ„μ¨μ΄ 3.3 : 1 μ΄λ―€λ΅ λΉ„μ¨μ΄ λ§μ§€ μ•λ‹¤. <br>

μ¦‰, μƒν”λ§ νΈν–¥μ΄ μ΅°κΈμ΄μ§€λ§ λ‚νƒ€λ‚ κ²ƒμ΄λ‹¤. <br>
μ΄λ ‡κ² κ³¨κ³ λ£¨ μ„μ΄μ§€ μ•μ€ μ΄μ λ” μƒν” κ°μκ°€ μ μ–΄μ„ μ΄λ° μΌμ΄ μƒκΈ΄ κ²ƒμ΄λ‹¤. <br>

λ‹¤μ‹ μ›λ λΉ„μ¨λ€λ΅ λ§μ¶”κΈ° μ„ν•΄μ„ train_test_split() ν•¨μμ— **stratify λ§¤κ°λ³€μ**μ— νƒ€κΉƒ λ°μ΄ν„°λ¥Ό μ „λ‹¬ν•΄ λΉ„μ¨μ— λ§κ² λ°μ΄ν„°λ¥Ό λ‚λλ‹¤.
```python
train_input, test_input, train_target, test_target = train_test_split( fish_data, fish_target, stratify = fish_target, random_state = 42)
print(test_target)
```

![aft_stratify](/assets/images/ch02/stratify.JPG)

μ•„κΉ μλ μ°μ°ν–λ '1'μ€ μ‚¬λΌμ§€κ³  9κ°μ λ„λ―Έ(1), 4κ°μ λΉ™μ–΄(0)κ°€ μ¶λ ¥λκ³  λΉ„μ¨μ€ 2.25 : 1λ΅ μ•„κΉλ³΄λ‹¨ 2.5 : 1 κ³Ό κ·Όμ ‘ν• λΉ„μ¨μ΄ λμ—λ‹¤! <br>


### μμƒν• λ„λ―Έ ν• λ§λ¦¬

<br>
λ‹¤μ‹ k-μµκ·Όμ ‘ μ΄μ›ƒ ν›λ ¨μ„ ν•΄λ³΄μ. 
```python
from sklearn.neighbors import KNeighborsClassifier
kn = KNeighborsClassifier()
kn.fit(train_input, train_target)
kn.score(test_input, test_target)
```

![02_2_3_1](/assets/images/ch02/02_2_3_1.JPG)

1.0μ΄ λ‚μ™€μ„ μ •λ§ κΈ°λ¶„μ΄ μΆ‹λ‹¤. <br>
ν…μ¤νΈ μ„ΈνΈμ λ„λ―Έμ™€ λΉ™μ–΄λ¥Ό μ¬λ°”λ¥΄κ² λ¶„λ¥ν–λ‹¤λ” κ±Έ λ³΄μ—¬μ¤€λ‹¤. <br><br>
μ΄μ  λ‹¤μ‹ λ¬΄κ²κ°€ 25μ΄κ³  κΈΈμ΄κ°€ 150μΈ λ„λ―Έμ λ°μ΄ν„°λ¥Ό λ„£κ³  κ²°κ³Όλ¥Ό ν™•μΈν•΄λ³΄μ.
```python
print(kn.predict([[25,150]]))
```

![02_2_3_2](/assets/images/ch02/02_2_3_2.JPG)

~~λ‚΄ μ„Έμƒμ΄ λ¬΄λ„μ΅λ‹¤. λΉ™μ–΄λΌκ³  λ‚μ™”λ‹¤..~~ <br>
μ΄ μƒν”κ³Ό λ‹¤λ¥Έ λ°μ΄ν„°λ¥Ό ν•¨κ» μ‚°μ λ„λ΅ κ·Έλ ¤ ν™•μΈν•΄λ³΄μ. 
```python
import matplotlib.pyplot as plt
plt.scatter(train_input[:,0], train_input[:,1]) #0μ€ κΈΈμ΄ 1μ€ λ¬΄κ²
plt.scatter(25, 150, marker = '^')
plt.xlabel('length')
plt.ylabel('weight')
plt.show()
```

![02_2_3_3](/assets/images/ch02/02_2_3_3.JPG)

π”Ίκ°€ 25, 150μΈ λ°μ΄ν„°μΈλ° κ·Έλν”„μƒ μ¤λ¥Έμ½ μ„λ΅ λ»—μ–΄ μλ” λ„λ―Έ λ°μ΄ν„°μ— λ” κ°€κΉμ΄λ° μ™ μ™Όμ½ μ•„λμ λΉ™μ–΄ λ°μ΄ν„°μ™€ κ°€κΉλ‹¤κ³  λ‚μ¤λ” κ±ΈκΉ? <br>

k-μµκ·Όμ ‘ μ΄μ›ƒμ€ μ£Όλ³€μ μƒν” μ¤‘μ—μ„ λ‹¤μμΈ ν΄λμ¤λ¥Ό μμΈ΅μΌλ΅ μ‚¬μ©ν•λ‹¤.<br>
μ΄ μƒν”μ μ£Όλ³€ μƒν”μ„ μ•μ•„λ³΄μ. <br><br>
KNeighborsClassifier ν΄λμ¤λ” μ£Όμ–΄μ§„ μƒν”μ—μ„ κ°€μ¥ κ°€κΉμ΄ μ΄μ›ƒμ„ μ°Ύμ•„ μ£Όλ” kneighbors() λ©”μ„λ“λ¥Ό μ κ³µν•λ”λ° μ΄ λ©”μ„λ“λ” μ΄μ›ƒκΉμ§€μ κ±°λ¦¬μ™€ μ΄μ›ƒ μƒν”μ μΈλ±μ¤λ¥Ό λ°ν™ν•λ‹¤. <br>
KNeighborsClassifier ν΄λμ¤μ μ΄μ›ƒ κ°μμΈ n_neighborsμ κΈ°λ³Έκ°’μ€ 5μ΄λ―€λ΅ 5κ°μ μ΄μ›ƒμ΄ λ°ν™λλ‹¤. 
```python
distances, indexes = kn.kneighbors([[25,150]])
kn.kneighbors([[25, 150]])
```

![02_2_3_4](/assets/images/ch02/02_2_3_4.JPG)

kn.kneighbors([[25, 150]])μ„ μ¶λ ¥ν• κ²°κ³Όλ¥Ό ν†µν•΄ μ• μ μλ“―μ΄, [[25, 150]]κ³Ό κ°€μ¥ κ°€κΉμ΄ 5κ° μ΄μ›ƒκΉμ§€μ κ±°λ¦¬ λ°°μ—΄κ³Ό 5κ° μ΄μ›ƒ μƒν”μ μΈλ±μ¤κ°€ λ°ν™λλ‹¤. <br>
κµ¬ν• indexes λ°°μ—΄μ„ μ‚¬μ©ν•΄ ν›λ ¨ λ°μ΄ν„° μ¤‘μ—μ„ μ΄μ›ƒ μƒν”μ„ λ”°λ΅ κµ¬λ¶„ν•΄ κ·Έλ ¤λ³΄μ.
```python
plt.scatter(train_input[:, 0], train_input[:, 1])
plt.scatter(25, 150, marker = '^')
plt.scatter(train_input[indexes, 0], train_input[indexes, 1], marker = 'D')
plt.xlabel('length')
plt.ylabel('weight')
plt.show()
```

> marker = '^'λ” μ„Έλ¨λ΅, marker = 'D'λ” λ§λ¦„λ¨λ΅ ν‘μ‹λλ‹¤. 

![02_2_3_5](/assets/images/ch02/02_2_3_5.JPG)

μ΄λ΅μƒ‰ π”· 5κ°κ°€ π”Ίμ— κ°€μ¥ κ°€κΉμ΄ μƒν”λ΅ ν‘μ‹λλ‹¤. <br>



### κΈ°μ¤€μ„ λ§μ¶°λΌ


### μ „μ²λ¦¬ λ°μ΄ν„°λ΅ λ¨λΈ ν›λ ¨ν•κΈ°


### μ¤μΌ€μΌμ΄ λ‹¤λ¥Έ νΉμ„± μ²λ¦¬
