---
title: "[ch02] νΌμ κ³µλ¶€ν•λ” λ¨Έμ‹ λ¬λ‹ + λ”¥λ¬λ‹"
description: λ°μ΄ν„° λ‹¤λ£¨κΈ° _ μμƒν• μƒμ„ μ„ μ΅°μ‹¬ν•λΌ!
categories: 
 - νΌκ³µλ¨Έμ‹ 
tags: [AI, Machine Learning, Deep Learning]
---

<!-- λ‚΄μ© -->

# 02-1 ν›λ ¨ μ„ΈνΈμ™€ ν…μ¤νΈ μ„ΈνΈ

### μ§€λ„ ν•™μµκ³Ό λΉ„μ§€λ„ ν•™μµ

λ¨Έμ‹ λ¬λ‹ μ•κ³ λ¦¬μ¦μ€ ν¬κ² **μ§€λ„ ν•™μµ**κ³Ό **λΉ„μ§€λ„ ν•™μµ**μΌλ΅ λ‚λ‰λ‹¤.  *κ°•ν™” ν•™μµλ„ μλ”λ° μ΄ μ±…μ—μ„λ” λ‹¤λ£¨μ§€ μ•λ”λ‹¤.*<br>
1μ¥μ—μ„ λ„λ―Έμ™€ λΉ™μ–΄μ λ°μ΄ν„°λ¥Ό κ°€μ§€κ³  ν• μ•κ³ λ¦¬μ¦μ΄ **μ§€λ„ ν•™μµ**μ΄κ³ , μ§€λ„ ν•™μµ μ•κ³ λ¦¬μ¦μ€ ν›λ ¨ν•κΈ° μ„ν• λ°μ΄ν„°μ™€ μ •λ‹µμ΄ ν•„μ”ν•λ‹¤. <br>
μ§€λ„ ν•™μµμ—μ„ λ°μ΄ν„°λ¥Ό **μ…λ ¥(input)**, μ •λ‹µμ„ **νƒ€κΉƒ(target)**μ΄λΌκ³  ν•κ³  μ΄ λ‘μ„ ν•©μ³ **ν›λ ¨ λ°μ΄ν„°(training data)**λΌκ³  ν•λ‹¤. <br>
μ§€λ„ ν•™μµμ€ μ •λ‹µ(νƒ€κΉƒ)μ΄ μμ–΄μ„ μ•κ³ λ¦¬μ¦μ΄ μ •λ‹µμ„ λ§νλ” κ²ƒμ„ ν•™μµν•μ§€λ§ **λΉ„μ§€λ„ ν•™μµ**μ€ νƒ€κΉƒ μ—†μ΄ **μ…λ ¥ λ°μ΄ν„°λ§** μ‚¬μ©ν•λ‹¤. <br>
μ •λ‹µμ„ μ‚¬μ©ν•μ§€ μ•μΌλ―€λ΅ λ¬΄μ–Έκ°€λ¥Ό λ§ν μλ” μ—†μ§€λ§ λ°μ΄ν„°λ¥Ό νμ•…ν•κ±°λ‚ λ³€ν•ν•λ” λ°λ” μΆ‹λ‹¤. <br>
π‘‰ μ…λ ¥ λ°μ΄ν„°λ§ μμ„ λ• λΉ„μ§€λ„ ν•™μµ μ•κ³ λ¦¬μ¦μ„ μ‚¬μ©ν•κΈ° μΆ‹λ‹¤! <br>

k-μµκ·Όμ ‘ μ΄μ›ƒ μ•κ³ λ¦¬μ¦μ„ μ΄μ©ν• λ¨λΈμ΄ λ„λ―Έμ™€ λΉ™μ–΄λ¥Ό μ™„λ²½ν•κ² νλ³„ν–λ”λ° κ³Όμ—° μ™„λ²½ν• λ¨λΈμΌκΉ ? <br><br>

### ν›λ ¨ μ„ΈνΈμ™€ ν…μ¤νΈ μ„ΈνΈ

1μ¥μ—μ„λ” μ§€λ„ ν•™μµ μ•κ³ λ¦¬μ¦μ„ μ΄μ©ν–μΌλ―€λ΅ 2μ¥μ—μ„λ” λΉ„μ§€λ„ ν•™μµ μ•κ³ λ¦¬μ¦μ„ μ΄μ©ν•λ‹¤. <br>
μ•μ—μ„λ” μ…λ ¥κ³Ό νƒ€κΉƒμ„ μ£Όκ³  ν›λ ¨ν•κ³  ν›λ ¨μ— μ“°μΈ λ°μ΄ν„°λ΅ ν…μ¤νΈλ¥Ό ν–κΈ° λ•λ¬Έμ— λ„λ―Έμ™€ λΉ™μ–΄λ¥Ό μ™„λ²½ν•κ² νλ³„ν–λ‹¤.<br>
*(μ–΄μ°λ³΄λ©΄ λ‹Ήμ—°ν• μ–κΈ°)* <br>

λΉ„μ§€λ„ ν•™μµ μ•κ³ λ¦¬μ¦μ—μ„λ” ν›λ ¨ν• λ°μ΄ν„°μ™€ ν…μ¤νΈν•λ” λ°μ΄ν„°λ¥Ό λ‹¤λ¥΄κ² ν•κ³  μ•κ³ λ¦¬μ¦μ μ„±λ¥μ„ ν‰κ°€ν•λ‹¤. <br>
κ·Έλ¬λ―€λ΅ μ •ν™•ν• ν‰κ°€λ¥Ό μ„ν•΄μ„λ” **ν›λ ¨ μ„ΈνΈ**μ™€ **ν…μ¤νΈ μ„ΈνΈ**κ°€ λ―Έλ¦¬ μ¤€λΉ„λμ–΄μ•Ό ν•λ‹¤. <br>

ν›λ ¨ μ„ΈνΈ(train set)
 : ν›λ ¨μ— μ‚¬μ©λλ” λ°μ΄ν„° <br><br>

ν…μ¤νΈ μ„ΈνΈ(test set)
 : ν‰κ°€μ— μ‚¬μ©ν•λ” λ°μ΄ν„°

1μ¥μ—μ„μ²λΌ λ„λ―Έμ™€ λΉ™μ–΄μ κΈΈμ΄μ™€ λ¬΄κ² λ°μ΄ν„°λ¥Ό κ°€μ Έμ¤λ”λ° λ‘μ λ°μ΄ν„°λ¥Ό ν•©μ³ ν•λ‚μ νμ΄μ¬ λ¦¬μ¤νΈλ΅ μ¤€λΉ„ν•λ‹¤. <br>
π‘‰ [λ„λ―Έμ™€ λΉ™μ–΄ λ¦¬μ¤νΈ](https://gist.github.com/rickiepark/b37d04a95a42ef6757e4a99214d61697)

```python
fish_length = [25.4, 26.3, 26.5, 29.0, 29.0, 29.7, 29.7, 30.0, 30.0, 30.7, 31.0, 31.0, 
                31.5, 32.0, 32.0, 32.0, 33.0, 33.0, 33.5, 33.5, 34.0, 34.0, 34.5, 35.0, 
                35.0, 35.0, 35.0, 36.0, 36.0, 37.0, 38.5, 38.5, 39.5, 41.0, 41.0, 9.8, 
                10.5, 10.6, 11.0, 11.2, 11.3, 11.8, 11.8, 12.0, 12.2, 12.4, 13.0, 14.3, 15.0]
fish_weight = [242.0, 290.0, 340.0, 363.0, 430.0, 450.0, 500.0, 390.0, 450.0, 500.0, 475.0, 500.0, 
                500.0, 340.0, 600.0, 600.0, 700.0, 700.0, 610.0, 650.0, 575.0, 685.0, 620.0, 680.0, 
                700.0, 725.0, 720.0, 714.0, 850.0, 1000.0, 920.0, 955.0, 925.0, 975.0, 950.0, 6.7, 
                7.5, 7.0, 9.7, 9.8, 8.7, 10.0, 9.9, 9.8, 12.2, 13.4, 12.2, 19.7, 19.9]
```

κΈΈμ΄μ™€ λ¬΄κ²λ¥Ό ν•λ‚μ λ¦¬μ¤νΈλ΅ λ‹΄μ€ 2μ°¨μ› λ¦¬μ¤νΈλ΅ λ§λ“ λ‹¤.<br>
```python
fish_data = [[l, w] for l, w in zip(fish_length, fish_weight)]
fish_target = [1]*35 + [0]*14
```

μ΄λ• λ§λ“¤μ–΄μ§€λ” fish_dataλ” μ•„λμ™€ κ°™μ€ 2μ°¨μ› λ¦¬μ¤νΈ ν•νƒμΈλ°<br>
```python
fish_data = [[25.4, 242.0], [26.3, 290.0], [26.5, 340.0], [29.0, 363.0], [29.0, 430.0], [29.7, 450.0], [29.7, 500.0], [30.0, 390.0], [30.0, 450.0], [30.7, 500.0], [31.0, 475.0], [31.0, 500.0], [31.5, 500.0], [32.0, 340.0], [32.0, 600.0], [32.0, 600.0], [33.0, 700.0], [33.0, 700.0], [33.5, 610.0], [33.5, 650.0], [34.0, 575.0], [34.0, 685.0], [34.5, 620.0], [35.0, 680.0], [35.0, 700.0], [35.0, 725.0], [35.0, 720.0], [36.0, 714.0], [36.0, 850.0], [37.0, 1000.0], [38.5, 920.0], [38.5, 955.0], [39.5, 925.0], [41.0, 975.0], [41.0, 950.0], [9.8, 6.7], [10.5, 7.5], [10.6, 7.0], [11.0, 9.7], [11.2, 9.8], [11.3, 8.7], [11.8, 10.0], [11.8, 9.9], [12.0, 9.8], [12.2, 12.2], [12.4, 13.4], [13.0, 12.2], [14.3, 19.7], [15.0, 19.9]]
```

μ—¬κΈ°μ„ [25.4, 242.0], [26.3, 290.0]κ³Ό κ°™μ€ λ°μ΄ν„°λ¥Ό **μƒν”(sample)**μ΄λΌκ³  λ¶€λ¥Έλ‹¤. <br>
λ„λ―Έμ™€ λΉ™μ–΄κ°€ κ°κ° 35, 14λ§λ¦¬ μμΌλ―€λ΅ μ „μ²΄ λ°μ΄ν„°λ” 49κ°μ μƒν”μ΄ μκ³  μ‚¬μ©ν•λ” νΉμ„±μ€ κΈΈμ΄μ™€ λ¬΄κ²λ΅ 2κ°μ΄λ‹¤. <br>
μ΄ λ°μ΄ν„°μ 35κ°λ¥Ό ν›λ ¨ μ„ΈνΈ, 14κ°λ¥Ό ν…μ¤νΈ μ„ΈνΈλ΅ μ‚¬μ©ν•΄λ³΄μ.<br><br>

λ¨Όμ € μ‚¬μ΄ν‚·λ°μ KNeighborsClassifier ν΄λμ¤λ¥Ό importν•κ³  λ¨λΈ κ°μ²΄λ¥Ό λ§λ“ λ‹¤.<br>
```python
from sklearn.neighbors import KNeighborsClassifier
kn = KNeighborsClassifier()
```

κ·Έλ¦¬κ³  μ „μ²΄ λ°μ΄ν„°μ—μ„ μ²μ 35κ°λ¥Ό μ„ νƒν•λ‹¤. <br>
νμ΄μ¬μ—μ„ λ¦¬μ¤νΈμ μ”μ†λ¥Ό μ„ νƒν•  λ• **μΈλ±μ¤**λ¥Ό μ‚¬μ©ν•λ”λ° μ—¬κΈ°μ„λ„ μΈλ±μ¤μ™€ **μ¬λΌμ΄μ‹±**μ—°μ‚°μ„ ν†µν•΄ μ²« λ²μ§Έλ¶€ν„° λ‹¤μ„― λ²μ§ΈκΉμ§€μ μƒν”μ„ μ„ νƒν•΄λ³΄μ.<br>
```python
print(fish_data[0:5])
```

![μ¬λΌμ΄μ‹±](/assets/images/ch02/slice.JPG)

μ΄λ°μ‹μΌλ΅ ν›λ ¨ μ„ΈνΈμ™€ ν…μ¤νΈ μ„ΈνΈ κ°’μ„ μ§€μ •ν•΄λ³΄μ. <br><br>
```python
train_input = fish_data[:35] #ν›λ ¨ μ„ΈνΈμ λ°μ΄ν„°(μ…λ ¥)μ„ fish_dataμ 1~35λ² λ°μ΄ν„°λ΅ μ§€μ •
train_target = fish_target[:35] #ν›λ ¨ μ„ΈνΈμ μ •λ‹µ(νƒ€κΉƒ)μ„ fish_targetμ 1~35λ² κ°’μΌλ΅ μ§€μ •
test_input = fish_data[35:] #ν…μ¤νΈ μ„ΈνΈμ λ°μ΄ν„°(μ…λ ¥)μ„ fish_dataμ 36λ²~λ§μ§€λ§‰ λ°μ΄ν„°κΉμ§€ μ§€μ •
test_target = fish_target[35:] #ν…μ¤νΈ μ„ΈνΈμ μ •λ‹µ(νƒ€κΉƒ)μ„ fish_targetμ 36λ²~λ§μ§€λ§‰ κ°’μΌλ΅ μ§€μ •
```

μ¬λΌμ΄μ‹± μ—°μ‚°μΌλ΅ μΈλ±μ¤ 0~34κΉμ§€ μ²μ 35κ° μƒν”μ„ ν›λ ¨ μ„ΈνΈλ΅ μ§€μ •ν•κ³ , μΈλ±μ¤ 35~48κΉμ§€ λ‚λ¨Έμ§€ 14κ° μƒν”μ„ ν…μ¤νΈ μ„ΈνΈλ΅ μ§€μ •ν–λ‹¤. <br><br>
λ°μ΄ν„°λ¥Ό μ¤€λΉ„ν–μΌλ‹ ν›λ ¨ μ„ΈνΈλ΅ fit() λ©”μ„λ“λ¥Ό νΈμ¶ν•΄ λ¨λΈμ„ ν›λ ¨ν•κ³ , ν…μ¤νΈ μ„ΈνΈλ΅ score() λ©”μ„λ“λ¥Ό νΈμ¶ν•΄ ν‰κ°€ν•΄λ³΄μ. <br>
```python 
kn = kn.fit(train_input, train_target)
kn.score(test_input, test_target)
```

![κ²°κ³Ό](/assets/images/ch02/score1.JPG) <br>

μ •ν™•λ„κ°€ 0.0μ΄ λ‚μ™”λ”λ° λ€μ¶© λ‚΄λ ¤μ¤λ©΄μ„ μ΄μƒν•¨μ„ λμΉμ±„μ§€ μ•μ•λ‚μ” ? <br>
μ• 35κ° λ°μ΄ν„°λ” λ„λ―Έμ΄κ³  λ’· 14κ° λ°μ΄ν„°λ” λΉ™μ–΄μΈλ° λ„λ―Έλ΅ ν›λ ¨ν•κ³  λΉ™μ–΄λ΅ ν…μ¤νΈν•΄μ„λ‹¤. <br>
μ΄κ±Έ μ–΄λ–»κ² ν•΄κ²°ν•λ©΄ λ κΉ?π® <br><br>

### μƒν”λ§ νΈν–¥

μ›λ ν”„λ΅κ·Έλ¨μ λ©μ μ²λΌ ν–λ”λΌλ©΄ 
![sample](/assets/images/ch02/sample.jpg)
μ΄λ° ν›λ ¨ μ„ΈνΈμ™€ ν…μ¤νΈ μ„ΈνΈλ΅ ν›λ ¨ν•κ³  ν…μ¤νΈν–μ–΄μ•Ό ν•λ”λ° <br>

μ•μ—μ„ ν• ν›λ ¨κ³Ό ν…μ¤νΈλ”
![sampling_bias](/assets/images/ch02/sampling bias.jpg)
μ΄λ°μ‹μΌλ΅ νΈν–¥λ λ°μ΄ν„°λ΅ ν–λ‹¤.<br>

μ΄λ ‡κ² ν›λ ¨ μ„ΈνΈμ™€ ν…μ¤νΈ μ„ΈνΈμ— μƒν”μ΄ κ³¨κ³ λ£¨ μ„μ—¬ μμ§€ μ•κ³  μƒν”λ§μ΄ ν•μ½μΌλ΅ μΉμ°μΉ κ±Έ **μƒν”λ§ νΈν–¥(sampling bias)**λΌκ³  ν•λ‹¤. <br>
μƒν”λ§ νΈν–¥λ•λ¬Έμ— μ •ν™•λ„κ°€ 0.0μ΄ λ‚μ™”λ κ±°λ‹¤. <br>

κ·Έλ ‡λ‹¤λ©΄ μ›λμ λ©μ μ²λΌ μ μ„μΈ ν›λ ¨ μ„ΈνΈλ¥Ό λ§λ“¤μ–΄λ³΄μ. <br><br>

### λ„νμ΄





------------

### λ‘ λ²μ§Έ λ¨Έμ‹ λ¬λ‹ ν”„λ΅κ·Έλ¨
